begin;
    
        
        
    

    

    merge into staging_BALBOA.source_dbt_artifacts.dim_dbt__sources as DBT_INTERNAL_DEST
        using staging_BALBOA.source_dbt_artifacts.dim_dbt__sources__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.manifest_source_id = DBT_INTERNAL_DEST.manifest_source_id
        

    
    when matched then update set
        "MANIFEST_SOURCE_ID" = DBT_INTERNAL_SOURCE."MANIFEST_SOURCE_ID","COMMAND_INVOCATION_ID" = DBT_INTERNAL_SOURCE."COMMAND_INVOCATION_ID","DBT_CLOUD_RUN_ID" = DBT_INTERNAL_SOURCE."DBT_CLOUD_RUN_ID","ARTIFACT_RUN_ID" = DBT_INTERNAL_SOURCE."ARTIFACT_RUN_ID","ARTIFACT_GENERATED_AT" = DBT_INTERNAL_SOURCE."ARTIFACT_GENERATED_AT","NODE_ID" = DBT_INTERNAL_SOURCE."NODE_ID","NODE_DATABASE" = DBT_INTERNAL_SOURCE."NODE_DATABASE","NODE_DESCRIPTION" = DBT_INTERNAL_SOURCE."NODE_DESCRIPTION","NAME" = DBT_INTERNAL_SOURCE."NAME","SOURCE_NAME" = DBT_INTERNAL_SOURCE."SOURCE_NAME","SOURCE_LOADER" = DBT_INTERNAL_SOURCE."SOURCE_LOADER","SOURCE_SCHEMA" = DBT_INTERNAL_SOURCE."SOURCE_SCHEMA","PACKAGE_NAME" = DBT_INTERNAL_SOURCE."PACKAGE_NAME","RELATION_NAME" = DBT_INTERNAL_SOURCE."RELATION_NAME","SOURCE_PATH" = DBT_INTERNAL_SOURCE."SOURCE_PATH"
    

    when not matched then insert
        ("MANIFEST_SOURCE_ID", "COMMAND_INVOCATION_ID", "DBT_CLOUD_RUN_ID", "ARTIFACT_RUN_ID", "ARTIFACT_GENERATED_AT", "NODE_ID", "NODE_DATABASE", "NODE_DESCRIPTION", "NAME", "SOURCE_NAME", "SOURCE_LOADER", "SOURCE_SCHEMA", "PACKAGE_NAME", "RELATION_NAME", "SOURCE_PATH")
    values
        ("MANIFEST_SOURCE_ID", "COMMAND_INVOCATION_ID", "DBT_CLOUD_RUN_ID", "ARTIFACT_RUN_ID", "ARTIFACT_GENERATED_AT", "NODE_ID", "NODE_DATABASE", "NODE_DESCRIPTION", "NAME", "SOURCE_NAME", "SOURCE_LOADER", "SOURCE_SCHEMA", "PACKAGE_NAME", "RELATION_NAME", "SOURCE_PATH")

;
    commit;