begin;
    
        
        
    

    

    merge into staging_BALBOA.source_dbt_artifacts.fct_dbt__run_results as DBT_INTERNAL_DEST
        using staging_BALBOA.source_dbt_artifacts.fct_dbt__run_results__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.command_invocation_id = DBT_INTERNAL_DEST.command_invocation_id
        

    
    when matched then update set
        "ARTIFACT_GENERATED_AT" = DBT_INTERNAL_SOURCE."ARTIFACT_GENERATED_AT","COMMAND_INVOCATION_ID" = DBT_INTERNAL_SOURCE."COMMAND_INVOCATION_ID","DBT_CLOUD_RUN_ID" = DBT_INTERNAL_SOURCE."DBT_CLOUD_RUN_ID","ARTIFACT_RUN_ID" = DBT_INTERNAL_SOURCE."ARTIFACT_RUN_ID","DBT_VERSION" = DBT_INTERNAL_SOURCE."DBT_VERSION","ELAPSED_TIME" = DBT_INTERNAL_SOURCE."ELAPSED_TIME","EXECUTION_COMMAND" = DBT_INTERNAL_SOURCE."EXECUTION_COMMAND","SELECTED_MODELS" = DBT_INTERNAL_SOURCE."SELECTED_MODELS","TARGET" = DBT_INTERNAL_SOURCE."TARGET","WAS_FULL_REFRESH" = DBT_INTERNAL_SOURCE."WAS_FULL_REFRESH"
    

    when not matched then insert
        ("ARTIFACT_GENERATED_AT", "COMMAND_INVOCATION_ID", "DBT_CLOUD_RUN_ID", "ARTIFACT_RUN_ID", "DBT_VERSION", "ELAPSED_TIME", "EXECUTION_COMMAND", "SELECTED_MODELS", "TARGET", "WAS_FULL_REFRESH")
    values
        ("ARTIFACT_GENERATED_AT", "COMMAND_INVOCATION_ID", "DBT_CLOUD_RUN_ID", "ARTIFACT_RUN_ID", "DBT_VERSION", "ELAPSED_TIME", "EXECUTION_COMMAND", "SELECTED_MODELS", "TARGET", "WAS_FULL_REFRESH")

;
    commit;